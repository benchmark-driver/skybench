#!/bin/bash -e
#
# What this system should do:
#
# 1. git pull skybench (already done before this script)
# 2. update all release benchmark yamls
# 3. build ruby revisions
# 4. update all revision benchmarks yamls
# 5. git commit && git pull --rebase && git push skybench
#
eval "$(rbenv init -)"
set -x

repo_root="$(cd "$(dirname $0)"; cd ..; pwd)"
cd "$repo_root"
git submodule init && git submodule update

bundle check || bundle install -j24
bundle exec rake
